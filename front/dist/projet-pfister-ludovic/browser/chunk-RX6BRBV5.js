import{a as B}from"./chunk-62AXM7PA.js";import{a as N,c as V,f as W,k as z,l as R,m as A,p as j}from"./chunk-NPZKDYSZ.js";import{a as U}from"./chunk-XZSYQJT2.js";import{e as I,h as F}from"./chunk-QBIJVOJ4.js";import"./chunk-BPMLG3PT.js";import{a as D}from"./chunk-OFI7W5LO.js";import{j as T,k as E,m as k}from"./chunk-SDRDLNE6.js";import{$a as d,Aa as l,Ja as h,Oa as y,Ta as g,aa as C,ab as o,ba as P,bb as n,cb as O,hb as x,ib as m,jb as p,ob as S,pb as a,qb as b,rb as u,sb as w,tb as f,ub as _,vb as v,xb as L,ya as M}from"./chunk-4TET6FDT.js";var Y=i=>["/pollutions",i];function $(i,t){if(i&1&&(o(0,"option",17),a(1),n()),i&2){let e=t.$implicit;d("value",e),l(),u(" ",e," ")}}function G(i,t){i&1&&(o(0,"div",18),a(1," Chargement des pollutions... "),n())}function H(i,t){if(i&1&&(o(0,"div",19),a(1),n()),i&2){let e=p();l(),u(" ",e.error," ")}}function J(i,t){if(i&1&&(o(0,"div",20),a(1),n()),i&2){let e=p();l(),u(" ",e.filteredPollutions.length," pollution(s) trouv\xE9e(s) ")}}function K(i,t){if(i&1&&(o(0,"div",37),O(1,"img",38),n()),i&2){let e=p().$implicit;l(),d("src",e.photoUrl,M)("alt",e.titre)}}function Q(i,t){if(i&1&&(o(0,"div",32)(1,"strong"),a(2,"\u{1F464} Auteur :"),n(),a(3),n()),i&2){let e=p().$implicit;l(3),u(" ",e.auteur," ")}}function X(i,t){if(i&1){let e=x();o(0,"div",25),g(1,K,2,2,"div",26),o(2,"div",27)(3,"div",28)(4,"h3"),a(5),n(),o(6,"span",29),a(7),n()(),o(8,"p",30),a(9),n(),o(10,"div",31)(11,"div",32)(12,"strong"),a(13,"\u{1F4CD} Lieu :"),n(),a(14),n(),o(15,"div",32)(16,"strong"),a(17,"\u{1F4C5} Date :"),n(),a(18),n(),g(19,Q,4,1,"div",33),n(),o(20,"div",34)(21,"a",35),a(22," Voir d\xE9tails "),n(),o(23,"button",36),m("click",function(){let c=C(e).$implicit,s=p(2);return P(s.deletePollution(c.id))}),a(24," Supprimer "),n()()()()}if(i&2){let e=t.$implicit,r=p(2);l(),d("ngIf",e.photoUrl),l(4),b(e.titre),l(),S("badge-"+e.type.toLowerCase().replace(" ","-")),l(),u(" ",e.type," "),l(2),b(e.description),l(5),u(" ",e.lieu," "),l(4),u(" ",r.formatDate(e.dateObservation)," "),l(),d("ngIf",e.auteur),l(2),d("routerLink",L(10,Y,e.id))}}function Z(i,t){i&1&&(o(0,"div",39),a(1," Aucune pollution trouv\xE9e avec ces crit\xE8res. "),n())}function ee(i,t){if(i&1){let e=x();o(0,"div",40),a(1),o(2,"button",41),m("click",function(){let c=C(e).$implicit,s=p(2);return P(s.toggleFavorite(c))}),a(3),n()()}if(i&2){let e=t.$implicit,r=p(2);l(),w(" ",e.titre," - ",e.type," "),l(2),u(" \u2B50 ",r.favoriteService.isFavorite(e.id)?"Retirer":"Ajouter"," ")}}function te(i,t){if(i&1&&(o(0,"div",21),g(1,X,25,12,"div",22)(2,Z,2,0,"div",23)(3,ee,4,3,"div",24),n()),i&2){let e=p();l(),d("ngForOf",e.filteredPollutions),l(),d("ngIf",e.filteredPollutions.length===0),l(),d("ngForOf",e.filteredPollutions)}}var q=class i{constructor(t,e){this.pollutionService=t;this.favoriteService=e}pollutions=[];filteredPollutions=[];loading=!1;error=null;filterType="";filterTitre="";filterLieu="";pollutionTypes=["",...B];ngOnInit(){this.loadPollutions()}loadPollutions(){this.loading=!0,this.error=null,this.pollutionService.getAllPollutions().subscribe({next:t=>{this.pollutions=t,this.filteredPollutions=t,this.loading=!1},error:t=>{this.pollutions=[],this.filteredPollutions=[],this.loading=!1,console.warn("Backend non disponible:",t)}})}applyFilters(){this.filteredPollutions=this.pollutions.filter(t=>{let e=!this.filterType||t.type===this.filterType,r=!this.filterTitre||t.titre.toLowerCase().includes(this.filterTitre.toLowerCase()),c=!this.filterLieu||t.lieu.toLowerCase().includes(this.filterLieu.toLowerCase());return e&&r&&c})}resetFilters(){this.filterType="",this.filterTitre="",this.filterLieu="",this.filteredPollutions=this.pollutions}deletePollution(t){t&&confirm("\xCAtes-vous s\xFBr de vouloir supprimer cette pollution ?")&&this.pollutionService.deletePollution(t).subscribe({next:()=>{this.pollutions=this.pollutions.filter(e=>e.id!==t),this.applyFilters()},error:e=>{alert("Erreur lors de la suppression"),console.error("Erreur:",e)}})}formatDate(t){return new Date(t).toLocaleDateString("fr-FR")}toggleFavorite(t){this.favoriteService.isFavorite(t.id)?this.favoriteService.removeFromFavorites(t.id):this.favoriteService.addToFavorites(t)}static \u0275fac=function(e){return new(e||i)(h(U),h(D))};static \u0275cmp=y({type:i,selectors:[["app-pollution-list"]],decls:29,vars:8,consts:[[1,"list-container"],[1,"filters-section"],[1,"filters-grid"],[1,"filter-group"],["for","filterType"],["id","filterType",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","filterTitre"],["type","text","id","filterTitre","placeholder","Rechercher par titre...",3,"ngModelChange","input","ngModel"],["for","filterLieu"],["type","text","id","filterLieu","placeholder","Rechercher par lieu...",3,"ngModelChange","input","ngModel"],[1,"btn-reset-filters",3,"click"],["class","loading",4,"ngIf"],["class","error-message",4,"ngIf"],["class","results-count",4,"ngIf"],["class","pollutions-grid",4,"ngIf"],[3,"value"],[1,"loading"],[1,"error-message"],[1,"results-count"],[1,"pollutions-grid"],["class","pollution-card",4,"ngFor","ngForOf"],["class","no-results",4,"ngIf"],["class","pollution-item",4,"ngFor","ngForOf"],[1,"pollution-card"],["class","card-image",4,"ngIf"],[1,"card-content"],[1,"card-header"],[1,"badge"],[1,"card-description"],[1,"card-info"],[1,"info-item"],["class","info-item",4,"ngIf"],[1,"card-actions"],[1,"btn","btn-view",3,"routerLink"],[1,"btn","btn-delete",3,"click"],[1,"card-image"],[3,"src","alt"],[1,"no-results"],[1,"pollution-item"],[3,"click"]],template:function(e,r){e&1&&(o(0,"div",0)(1,"h2"),a(2,"Liste des pollutions"),n(),o(3,"div",1)(4,"h3"),a(5,"Filtrer les r\xE9sultats"),n(),o(6,"div",2)(7,"div",3)(8,"label",4),a(9,"Type de pollution"),n(),o(10,"select",5),v("ngModelChange",function(s){return _(r.filterType,s)||(r.filterType=s),s}),m("change",function(){return r.applyFilters()}),o(11,"option",6),a(12,"Tous les types"),n(),g(13,$,2,2,"option",7),n()(),o(14,"div",3)(15,"label",8),a(16,"Titre"),n(),o(17,"input",9),v("ngModelChange",function(s){return _(r.filterTitre,s)||(r.filterTitre=s),s}),m("input",function(){return r.applyFilters()}),n()(),o(18,"div",3)(19,"label",10),a(20,"Lieu"),n(),o(21,"input",11),v("ngModelChange",function(s){return _(r.filterLieu,s)||(r.filterLieu=s),s}),m("input",function(){return r.applyFilters()}),n()(),o(22,"div",3)(23,"button",12),m("click",function(){return r.resetFilters()}),a(24," R\xE9initialiser "),n()()()(),g(25,G,2,0,"div",13)(26,H,2,1,"div",14)(27,J,2,1,"div",15)(28,te,4,3,"div",16),n()),e&2&&(l(10),f("ngModel",r.filterType),l(3),d("ngForOf",r.pollutionTypes.slice(1)),l(4),f("ngModel",r.filterTitre),l(4),f("ngModel",r.filterLieu),l(4),d("ngIf",r.loading),l(),d("ngIf",r.error),l(),d("ngIf",!r.loading&&!r.error),l(),d("ngIf",!r.loading&&!r.error))},dependencies:[k,T,E,F,I,j,R,A,N,z,V,W],styles:[".list-container[_ngcontent-%COMP%]{max-width:1200px;margin:2rem auto;padding:0 1rem}h2[_ngcontent-%COMP%]{margin-bottom:2rem;color:#333}.filters-section[_ngcontent-%COMP%]{background:#fff;padding:1.5rem;border-radius:8px;box-shadow:0 2px 8px #0000001a;margin-bottom:2rem}.filters-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1.1rem;color:#555}.filters-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;align-items:end}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:600;color:#555;font-size:.9rem}.filter-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:2px solid #ddd;border-radius:4px;font-size:.95rem}.btn-reset-filters[_ngcontent-%COMP%]{width:100%;padding:.75rem;background:#f44336;color:#fff;border:none;border-radius:4px;cursor:pointer;font-weight:600;transition:background .3s}.btn-reset-filters[_ngcontent-%COMP%]:hover{background:#d32f2f}.results-count[_ngcontent-%COMP%]{margin-bottom:1rem;font-weight:600;color:#666}.loading[_ngcontent-%COMP%], .error-message[_ngcontent-%COMP%]{padding:2rem;text-align:center;background:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a}.error-message[_ngcontent-%COMP%]{color:#f44336}.pollutions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1.5rem}.pollution-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a;overflow:hidden;transition:transform .3s,box-shadow .3s}.pollution-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 4px 12px #00000026}.card-image[_ngcontent-%COMP%]{height:200px;overflow:hidden}.card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.card-content[_ngcontent-%COMP%]{padding:1.5rem}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:start;margin-bottom:1rem;gap:1rem}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;color:#333;flex:1}.badge[_ngcontent-%COMP%]{padding:.4rem .8rem;border-radius:20px;font-size:.75rem;font-weight:600;white-space:nowrap}.badge-plastique[_ngcontent-%COMP%]{background:#ffe5b4;color:#8b4513}.badge-chimique[_ngcontent-%COMP%]{background:#ffe4e1;color:#dc143c}.badge-d\\e9p\\f4t-sauvage[_ngcontent-%COMP%]{background:#e6e6fa;color:indigo}.badge-eau[_ngcontent-%COMP%]{background:#e0f2f7;color:#0277bd}.badge-air[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.badge-autre[_ngcontent-%COMP%]{background:#f5f5f5;color:#616161}.card-description[_ngcontent-%COMP%]{color:#666;line-height:1.5;margin-bottom:1rem;display:-webkit-box;-webkit-box-orient:vertical;overflow:hidden}.card-info[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:.9rem}.info-item[_ngcontent-%COMP%]{margin-bottom:.5rem;color:#555}.card-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.btn[_ngcontent-%COMP%]{flex:1;padding:.75rem;border:none;border-radius:4px;font-weight:600;cursor:pointer;text-align:center;text-decoration:none;transition:all .3s}.btn-view[_ngcontent-%COMP%]{background:#2196f3;color:#fff}.btn-view[_ngcontent-%COMP%]:hover{background:#1976d2}.btn-delete[_ngcontent-%COMP%]{background:#f44336;color:#fff}.btn-delete[_ngcontent-%COMP%]:hover{background:#d32f2f}.no-results[_ngcontent-%COMP%]{grid-column:1 / -1;text-align:center;padding:3rem;color:#999;font-size:1.1rem}@media(max-width:768px){.pollutions-grid[_ngcontent-%COMP%], .filters-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{q as PollutionListComponent};
